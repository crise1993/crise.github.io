(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{593:function(t,a,e){"use strict";e.r(a);var s=e(65),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"h5-唤起-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#h5-唤起-app"}},[t._v("#")]),t._v(" H5 唤起 app")]),t._v(" "),e("h2",{attrs:{id:"导语"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导语"}},[t._v("#")]),t._v(" 导语")]),t._v(" "),e("p",[t._v("引导已下载用户打开 APP，从数据上说用户停留在 APP 中的时间更多了，是在提高用户粘性；从体验上说，APP 体验是要比 H5 好的。引导未下载用户下载 APP，可以增加我们的用户量。")]),t._v(" "),e("p",[t._v("我们的手机上有许多私密信息，联系方式、照片、银行卡信息...我们不希望这些信息可以被手机应用随意获取到，信息泄露的危害甚大。所以，如何保证个人信息在设备所有者知情并允许的情况下被使用，是智能设备的核心安全问题。\n对此，苹果使用了名为 沙盒 的机制：应用只能访问它声明可能访问的资源。但沙盒也阻碍了应用间合理的信息共享，某种程度上限制了应用的能力。\n因此，我们急需要一个辅助工具来帮助我们实现应用通信。")]),t._v(" "),e("h2",{attrs:{id:"常见的唤端方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见的唤端方式"}},[t._v("#")]),t._v(" 常见的唤端方式")]),t._v(" "),e("ol",[e("li",[t._v("URL Scheme")]),t._v(" "),e("li",[t._v("Intent")]),t._v(" "),e("li",[t._v("Universal Link")])]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"url-scheme-是什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#url-scheme-是什么"}},[t._v("#")]),t._v(" URL Scheme 是什么")]),t._v(" "),e("p",[t._v("我们来看一下 URL 的组成：")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("scheme:"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("//authority"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("?query"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#fragment]")]),t._v("\n")])])]),e("p",[t._v("复制代码我们拿 https://www.baidu.com 来举例，scheme 自然就是 https 了。\n就像给服务器资源分配一个 URL，以便我们去访问它一样，我们同样也可以给手机 APP 分配一个特殊格式的 URL，用来访问这个 APP 或者这个 APP 中的某个功能(来实现通信)。APP 得有一个标识，好让我们可以定位到它，它就是 URL 的 Scheme 部分。")]),t._v(" "),e("h4",{attrs:{id:"常用-app-的-url-scheme"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用-app-的-url-scheme"}},[t._v("#")]),t._v(" 常用 APP 的 URL Scheme")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("APP")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("毛豆")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("微信")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("支付宝")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("淘宝")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("微博")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("URL Scheme")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("newcar://")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("weixin://")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("alipay://")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("taobao://")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("sinaweibo://")])])])]),t._v(" "),e("h4",{attrs:{id:"url-scheme-地址使用方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#url-scheme-地址使用方式"}},[t._v("#")]),t._v(" URL Scheme 地址使用方式")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("var iframe "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document.createElement"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'iframe'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\niframe.style.display "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),t._v("\niframe.src "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" src\ndocument.body.appendChild"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iframe"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h4",{attrs:{id:"传统的-scheme-链接有以下几个痛点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#传统的-scheme-链接有以下几个痛点"}},[t._v("#")]),t._v(" 传统的 Scheme 链接有以下几个痛点：")]),t._v(" "),e("p",[t._v("在 ios 上会有确认弹窗提示用户是否打开，对于用户来说唤端，多出了一步操作。若用户未安装 APP ，也会有一个提示窗，告知我们 “打不开该网页，因为网址无效”。\n假如产品想实现监测用户有没有安装本 app，没有安装的话跳转到 app store 的话，这时候会发现，用户点击确认框稍微慢了点，后续的唤起 app store 的确认框也会弹出，而且覆盖在上一个弹框的上面。\n传统 Scheme 跳转无法得知唤端是否成功，Universal Link 唤端失败可以直接打开此链接对应的页面。")]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"universal-link"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#universal-link"}},[t._v("#")]),t._v(" Universal Link")]),t._v(" "),e("p",[e("RouterLink",{attrs:{to:"/blog/web/universal-link.html"}},[t._v("Universal 指南")])],1),t._v(" "),e("h3",{attrs:{id:"intent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#intent"}},[t._v("#")]),t._v(" intent")]),t._v(" "),e("p",[t._v("安卓原生谷歌浏览器必须传递 Intent 协议地址，才能唤起 APP。")]),t._v(" "),e("p",[t._v("它支持以下五个属性，其中 scheme 和 上面的 protocal 一样，其他四个都是 apk 相关信息，其中 package 和 scheme 必传：")]),t._v(" "),e("ul",[e("li",[t._v("package")]),t._v(" "),e("li",[t._v("action")]),t._v(" "),e("li",[t._v("category")]),t._v(" "),e("li",[t._v("component")]),t._v(" "),e("li",[t._v("scheme")])]),t._v(" "),e("p",[t._v("例如： "),e("code",[t._v("intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end")])]),t._v(" "),e("p",[t._v("使用 a 标签跳转或 window.location 跳转")]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"项目调用方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目调用方法"}},[t._v("#")]),t._v(" 项目调用方法")]),t._v(" "),e("ol",[e("li",[t._v("引用下载组件")])]),t._v(" "),e("ul",[e("li",[t._v("在当前页面头部展示 下载 header 和 'app 内打开' 按钮")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" callApp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'callApp'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nor\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" callApp "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'callApp'")]),t._v("\n")])])]),e("p",[t._v("callApp 传递出来的是一个对象，可以直接去调用对象里面的方法（不需要实例化）。")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("callApp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("schemeUrl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("callApp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("schemeUrl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" universalUrl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" downlink"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])])]),e("h4",{attrs:{id:"params"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#params"}},[t._v("#")]),t._v(" params")]),t._v(" "),e("h5",{attrs:{id:"schemeurl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#schemeurl"}},[t._v("#")]),t._v(" schemeUrl")]),t._v(" "),e("p",[t._v("类型: "),e("code",[t._v("string")]),e("br"),t._v("\n必填: ✅")]),t._v(" "),e("p",[t._v("URL Scheme 的 scheme 字段，是你要打开的 APP 的标识")]),t._v(" "),e("p",[t._v("毛豆 APP scheme 标识（newcar://openapi/）")]),t._v(" "),e("p",[t._v("跳 app 首页 url：newcar://openapi/openTab?tab=1")]),t._v(" "),e("p",[t._v("跳 app webview页 url：newcar://openapi/openWebview?title=xxx&url=xxx")]),t._v(" "),e("h5",{attrs:{id:"downlink"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#downlink"}},[t._v("#")]),t._v(" downlink")]),t._v(" "),e("p",[t._v("类型: "),e("code",[t._v("string")]),e("br"),t._v("\n必填: ❎")]),t._v(" "),e("p",[t._v("不填的话，假如系统没有下载 app，就不会跳转到下载链接\nAPP 下载地址，可以是 app store 地址，可以是 apk 资源地址，也可以是应用宝页面地址")]),t._v(" "),e("p",[t._v("毛豆 app store 地址：后端返回（"),e("code",[t._v("https://itunes.apple.com/cn/app/id1276437206")]),t._v(")")]),t._v(" "),e("p",[t._v("毛豆安卓 apk 资源地址：后端返回（例如："),e("code",[t._v("http://app.xxx.com/2019061921444751_newcar_49_2.3.5.1_1560951804540_app_self_xinchewap.apk")]),t._v("）")]),t._v(" "),e("p",[t._v("应用宝毛豆 app 地址："),e("code",[t._v("https://sj.qq.com/myapp/detail.htm?apkName=com.xxx.newcar")])]),t._v(" "),e("hr"),t._v(" "),e("h2",{attrs:{id:"tip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tip"}},[t._v("#")]),t._v(" tip")]),t._v(" "),e("ol",[e("li",[t._v("微信、微博、手百、QQ 等。\n这些应用能阻止唤端是因为它们直接屏蔽掉了 URL Scheme 。接下来可能就有看官疑惑了，微信中是可以打开大众点评的呀，微博里面可以打开优酷呀，那是如何实现的呢？\n它们都各自维护着一个白名单，如果你的域名在白名单内，那这个域名下所有的页面发起的 URL Scheme 就都会被允许。就像微信，如果你是腾讯的“家属”，你就可以加入白名单了，微信的白名单一般只包含着“家属”，除此外很难申请到白名单资质。但是微博之类的都是可以联系他们的渠道童鞋进行申请的，只是条件各不相同，比如微博的就是在你的 APP 中添加打开微博的入口，三个月内唤起超过 100w 次，就可以加入白名单了。")])]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("腾讯应用宝直接打开 APP 的某个功能\n刚刚我们说到，如果你不是微信的家属，那你是很难进入白名单的，所以在安卓中我们一般都是直接打开腾讯应用宝，ios 中 直接打开 App Store。点击腾讯应用宝中的“打开”按钮，可以直接唤起我们的 APP，但是无法打开 APP 中的某个功能（就是无法打开指定页面）。\n腾讯应用宝对外开放了一个叫做 APP Link 的申请，只要你申请了 APP Link，就可以通过在打开应用宝的时候在应用宝地址后面添加上 &android_schema={your_scheme} ，来打开指定的页面了。")])]),t._v(" "),e("h2",{attrs:{id:"参考文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档")]),t._v(" "),e("p",[t._v("[1]: github callapp doc：https://github.com/suanmei/callapp-lib")]),t._v(" "),e("p",[t._v("[2]: Universal Link 是个骗子：https://yq.aliyun.com/articles/608583")])])}),[],!1,null,null,null);a.default=n.exports}}]);