<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>移动端UI适配方案选择 | crise&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./assets/logo.png">
    <meta name="description" content="一名程序员/前端人的技术博客">
    
    <link rel="preload" href="/assets/css/0.styles.567624d3.css" as="style"><link rel="preload" href="/assets/js/app.92dc81f6.js" as="script"><link rel="preload" href="/assets/js/2.2d54ebdc.js" as="script"><link rel="preload" href="/assets/js/10.01084cac.js" as="script"><link rel="prefetch" href="/assets/js/11.bac0121f.js"><link rel="prefetch" href="/assets/js/12.4e876679.js"><link rel="prefetch" href="/assets/js/13.d3fce123.js"><link rel="prefetch" href="/assets/js/14.75510bd2.js"><link rel="prefetch" href="/assets/js/15.48750021.js"><link rel="prefetch" href="/assets/js/16.7952a809.js"><link rel="prefetch" href="/assets/js/17.10b72fbd.js"><link rel="prefetch" href="/assets/js/18.13c83f7d.js"><link rel="prefetch" href="/assets/js/19.31948ab8.js"><link rel="prefetch" href="/assets/js/20.dc4c0c1c.js"><link rel="prefetch" href="/assets/js/21.1b255fe0.js"><link rel="prefetch" href="/assets/js/22.2f1d66a8.js"><link rel="prefetch" href="/assets/js/23.cf0fa840.js"><link rel="prefetch" href="/assets/js/24.9cf68851.js"><link rel="prefetch" href="/assets/js/25.c501abdb.js"><link rel="prefetch" href="/assets/js/26.5f6dd563.js"><link rel="prefetch" href="/assets/js/27.74260c5a.js"><link rel="prefetch" href="/assets/js/28.ce8f13bc.js"><link rel="prefetch" href="/assets/js/29.06bdce57.js"><link rel="prefetch" href="/assets/js/3.e9d5348e.js"><link rel="prefetch" href="/assets/js/30.8204335f.js"><link rel="prefetch" href="/assets/js/31.01971e34.js"><link rel="prefetch" href="/assets/js/32.c9d7df95.js"><link rel="prefetch" href="/assets/js/33.96b6de7c.js"><link rel="prefetch" href="/assets/js/34.b813165e.js"><link rel="prefetch" href="/assets/js/35.615aded7.js"><link rel="prefetch" href="/assets/js/36.9c619b20.js"><link rel="prefetch" href="/assets/js/37.90ffb782.js"><link rel="prefetch" href="/assets/js/38.1967fbbd.js"><link rel="prefetch" href="/assets/js/39.0d735efe.js"><link rel="prefetch" href="/assets/js/4.ca421095.js"><link rel="prefetch" href="/assets/js/40.923e5594.js"><link rel="prefetch" href="/assets/js/41.fd7797b4.js"><link rel="prefetch" href="/assets/js/42.7177cfca.js"><link rel="prefetch" href="/assets/js/43.b745c235.js"><link rel="prefetch" href="/assets/js/44.6fa2e561.js"><link rel="prefetch" href="/assets/js/45.9ecc0f19.js"><link rel="prefetch" href="/assets/js/46.d47edb5a.js"><link rel="prefetch" href="/assets/js/47.f48a72bc.js"><link rel="prefetch" href="/assets/js/48.19da9fb3.js"><link rel="prefetch" href="/assets/js/49.a5d16804.js"><link rel="prefetch" href="/assets/js/5.1898d05c.js"><link rel="prefetch" href="/assets/js/50.5efb3589.js"><link rel="prefetch" href="/assets/js/51.6a21aa98.js"><link rel="prefetch" href="/assets/js/52.2947ff47.js"><link rel="prefetch" href="/assets/js/53.dc63262e.js"><link rel="prefetch" href="/assets/js/54.fa9b8371.js"><link rel="prefetch" href="/assets/js/55.d0f31e05.js"><link rel="prefetch" href="/assets/js/56.de8ec14d.js"><link rel="prefetch" href="/assets/js/57.73331274.js"><link rel="prefetch" href="/assets/js/58.4f67425f.js"><link rel="prefetch" href="/assets/js/59.318ec5bd.js"><link rel="prefetch" href="/assets/js/6.c999d008.js"><link rel="prefetch" href="/assets/js/60.f6a602f9.js"><link rel="prefetch" href="/assets/js/61.c659faf6.js"><link rel="prefetch" href="/assets/js/62.4ccc91f2.js"><link rel="prefetch" href="/assets/js/63.6e5e36a9.js"><link rel="prefetch" href="/assets/js/64.2660e08e.js"><link rel="prefetch" href="/assets/js/65.b06b0bed.js"><link rel="prefetch" href="/assets/js/66.1f836a7a.js"><link rel="prefetch" href="/assets/js/67.add88f29.js"><link rel="prefetch" href="/assets/js/68.e74a51fc.js"><link rel="prefetch" href="/assets/js/69.63126800.js"><link rel="prefetch" href="/assets/js/7.92efcfae.js"><link rel="prefetch" href="/assets/js/70.1dc8f877.js"><link rel="prefetch" href="/assets/js/71.856f3fe1.js"><link rel="prefetch" href="/assets/js/72.927e4ce2.js"><link rel="prefetch" href="/assets/js/73.2c1e909e.js"><link rel="prefetch" href="/assets/js/74.c8b565d2.js"><link rel="prefetch" href="/assets/js/75.00537c0a.js"><link rel="prefetch" href="/assets/js/76.492fbce1.js"><link rel="prefetch" href="/assets/js/77.6fb48b9b.js"><link rel="prefetch" href="/assets/js/78.d5aea725.js"><link rel="prefetch" href="/assets/js/8.81eb0648.js"><link rel="prefetch" href="/assets/js/9.1bebc5a8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.567624d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">crise's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法题库
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微博
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端工程化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/ui-fit.html" aria-current="page" class="active sidebar-link">移动端UI适配方案选择</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_1-基本知识点" class="sidebar-link">1 基本知识点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_1-1-像素相关" class="sidebar-link">1.1 像素相关</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_1-2-viewport相关" class="sidebar-link">1.2 viewport相关</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_2-方案选择" class="sidebar-link">2 方案选择</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_2-1-media方案" class="sidebar-link">2.1 @media方案</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_2-2-rem适配方案" class="sidebar-link">2.2 rem适配方案</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_2-3-viewport-适配方案" class="sidebar-link">2.3 viewport 适配方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_3-viewport适配方案特定场景问题" class="sidebar-link">3 viewport适配方案特定场景问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_3-1-行内样式的场景" class="sidebar-link">3.1 行内样式的场景</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_3-2-1px-的问题" class="sidebar-link">3.2 1px 的问题</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#_3-3-图片高清还原的问题" class="sidebar-link">3.3 图片高清还原的问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/ui-fit.html#参考文档" class="sidebar-link">参考文档</a></li></ul></li><li><a href="/blog/engineer/cli.html" class="sidebar-link">从 0 打造属于自己的脚手架</a></li><li><a href="/blog/engineer/vue3-template.html" class="sidebar-link">从 0 搭建 vue3+vite+typescript 企业级项目</a></li><li><a href="/blog/engineer/library-template.html" class="sidebar-link">从 0 搭建 rollup + typescript + jest 工具库</a></li><li><a href="/blog/engineer/eslintrc.html" class="sidebar-link">ESLint使用、原理及配置规则详解</a></li><li><a href="/blog/engineer/ci-cd.html" class="sidebar-link">工程化之CI/CD方案总结</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ts系列</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/tsconfig.html" class="sidebar-link">tsconfig.json配置详解</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>打包工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/bundle/babel.html" class="sidebar-link">babel</a></li><li><a href="/blog/engineer/bundle/babel-plugin.html" class="sidebar-link">babel常用插件</a></li><li><a href="/blog/engineer/bundle/rollup.html" class="sidebar-link">一文教会你配置rollup</a></li><li><a href="/blog/engineer/bundle/rollup-plugin.html" class="sidebar-link">rollup插件详解</a></li><li><a href="/blog/engineer/bundle/vite.html" class="sidebar-link">vite原理篇</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>web跨端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架与原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机与网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>运维与安全</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="移动端ui适配方案选择"><a href="#移动端ui适配方案选择" class="header-anchor">#</a> 移动端UI适配方案选择</h1> <h2 id="_1-基本知识点"><a href="#_1-基本知识点" class="header-anchor">#</a> 1 基本知识点</h2> <h3 id="_1-1-像素相关"><a href="#_1-1-像素相关" class="header-anchor">#</a> 1.1 像素相关</h3> <h4 id="_1-1-1-屏幕尺寸"><a href="#_1-1-1-屏幕尺寸" class="header-anchor">#</a> 1.1.1 屏幕尺寸</h4> <p>显示器对角线的长度。量出来显示器面板的长和宽，再利用勾股定理求出对角线的长度，再通过单位换算，就得出这台显示器的屏幕尺寸
<code>单位：英寸（Inch）</code>并非面积单位，它是一个长度单位，<code>1英寸=2.54厘米</code>。</p> <p><img src="/assets/img/inch.eadac270.jpeg" alt="inch"></p> <h4 id="_1-1-2-设备像素-也叫物理像素-dp-device-pixels"><a href="#_1-1-2-设备像素-也叫物理像素-dp-device-pixels" class="header-anchor">#</a> 1.1.2 设备像素（也叫物理像素，DP-device pixels）</h4> <p>指设备能控制显示的最小物理单位，意指显示器上一个个的点。每个物理像素由颜色值和亮度值组成。从屏幕在工厂生产出的那天起，它上面设备像素点就固定不变了，和屏幕尺寸大小有关，单位 pt。</p> <h4 id="_1-1-3-屏幕分辨率"><a href="#_1-1-3-屏幕分辨率" class="header-anchor">#</a> 1.1.3 屏幕分辨率</h4> <p>显示器1080p分辨率的实际含义指的是显示器面板横向距离分布了1920个像素点（物理像素），纵向距离则分布1080个像素点。也就是1920*1080PX。</p> <p>电脑分辨率越高，显示内容就越多。原来1920*1080像素的图像，在1080p分辨率打开这张图像，这张图像铺满整个屏幕。在4K分辨率的显示器中打开这张图片时，只占据了约屏幕四分之一的位置。</p> <h4 id="_1-1-4-屏幕像素密度-ppi"><a href="#_1-1-4-屏幕像素密度-ppi" class="header-anchor">#</a> 1.1.4 屏幕像素密度（PPI）</h4> <p>是计算的显示器对角线上每英寸(1英寸=2.54厘米)直线穿过的像素数，而不是每平方英寸的面积中拥有的像素数。</p> <p><img src="https://ui.tedu.cn/upload/20171211/20171211112331_967.jpg" alt="ppi"></p> <h4 id="_1-1-5-显示器ppi高了有啥好处"><a href="#_1-1-5-显示器ppi高了有啥好处" class="header-anchor">#</a> 1.1.5 显示器PPI高了有啥好处？</h4> <p>先前我们已经清楚PPI如何计算的，并且知道它的定义是什么了。那它在实际生活中的又该如何应用呢？</p> <p>这就要先聊聊乔老爷子的iPhone4了，当年iPhone4的发布会中，乔老爷子提出了一个概念：<code>视网膜（Retina）屏幕</code>。它的定义是“PPI300以上屏幕在10英寸（25.4厘米）外观看时，人眼不会察觉到像素点的存在，屏幕显示效果就十分细腻，图像细节也会很丰富。”也就是说显示屏幕的PPI越高，你看到的画面就越精细。</p> <h4 id="_1-1-6-设备独立像素-也叫逻辑像素-dip"><a href="#_1-1-6-设备独立像素-也叫逻辑像素-dip" class="header-anchor">#</a> 1.1.6 设备独立像素(也叫逻辑像素，DIP)</h4> <p>设备独立像素（device independent pixels）是操作系统定义的一种像素单位，应用程序将设备独立像素告诉操作系统，操作系统再将设备独立像素转化为设备像素，从而控制屏幕上真正的物理像素点。</p> <p>为什么需要在应用程序与设备像素之间定义这么一种单位呢？为什么应用程序不应该直接使用设备像素？</p> <p>例如原先在 1280×720 设备分辨率的显示屏中，显示高度为 12 个设备像素的字体，现在放到设备分辨率为 2560 ×1440 的显示屏中，如果要想得到原先的大小，则需要 24 个设备像素，如果应用程序直接使用设备像素，那么编写应用程序则将变得非常困难，需要编写应用程序逻辑：字体在一些屏幕上高度为 12 个设备像素，在另一些屏幕上却需要 24 个设备像素。</p> <p>操作系统保证：用设备独立像素定义的尺寸，不管屏幕的参数如何，都能以合适的大小显示（这也是设备独立像素名字的由来）。操作系统是如何做到的呢？对于那些像素密度高的屏幕，将多个设备像素划分为一个逻辑像素。至于将多少设备像素划分为一个逻辑像素，这由操作系统决定。
对于上面的例子：“原本高度为 12 个设备像素的字体，现在高度为 24 个设备像素才能得到相同的大小”，操作系统会将一个逻辑像素定义为 2*2个 真实像素，从而设备独立像素尺寸不需要改变，而且不管在新、旧设备上，显示的尺寸大致相同。</p> <h4 id="_1-1-7-逻辑分辨率"><a href="#_1-1-7-逻辑分辨率" class="header-anchor">#</a> 1.1.7 逻辑分辨率</h4> <p>用屏幕的 宽高 来表示（单位：设备独立像素），我们通过操作系统的分辨率设置来改变设备独立像素的大小。例如屏幕的设备分辨率是1920<em>1200（单位：设备像素），我们可以在当前的分辨率下设置逻辑分辨率是1280</em>800（单位：设备独立像素）。那么横、纵方向的设备像素数量恰好是设备独立像素的1.5倍。这也意味着，设备独立像素的边长是设备像素边长的1.5倍。
​</p> <h4 id="_1-1-8-设备像素比-dpr"><a href="#_1-1-8-设备像素比-dpr" class="header-anchor">#</a> 1.1.8 设备像素比（DPR）</h4> <p>window.devicePixelRatio 设备像素比，devicePixelRatio = （在相同长度的直线上）设备像素的数量 / 设备独立像素的数量。这个比例默认缩放为100%的情况下，设备像素和CSS像素的比值。也等价于 CSS 像素边长/设备像素边长。
<img src="/assets/img/dpr.d94ea76b.png" alt="dpr"></p> <h4 id="_1-1-9-css-像素"><a href="#_1-1-9-css-像素" class="header-anchor">#</a> 1.1.9 CSS 像素</h4> <p>css像素是设备独立像素的一种。在 CSS 中使用的 px 都是指 css 像素，比如 width: 128px。css 像素的大小是很容易变化的，当我们缩放页面的时候，元素的 css 像素数量不会改变，改变的只是每个 css 像素的大小。也就是说 width: 128px 的元素在缩放200% 以后，宽度依然是 128 个 css 像素，只不过每个 css 像素的宽度和高度变为原来的两倍。如果原本元素宽度为 128 个设备独立像素，那么缩放 200% 以后元素宽度为 256 个设备独立像素。</p> <h5 id="_1-css-像素与设备独立像素的关系"><a href="#_1-css-像素与设备独立像素的关系" class="header-anchor">#</a> （1）css 像素与设备独立像素的关系</h5> <p>缩放比例就是 css 像素边长/设备独立像素边长；</p> <ul><li>在缩放比例为 100% 的情况下，1 个 css 像素大小等于 1 个设备独立像素；</li> <li>在缩放比例为 200% 的情况下，1 个 css 像素大小等于 (2 * 2)  个设备独立像素；</li></ul> <h5 id="​2-css-像素与设备像素的关系"><a href="#​2-css-像素与设备像素的关系" class="header-anchor">#</a> （​2）css 像素与设备像素的关系</h5> <p>默认缩放为100%的情况下，<code>devicePixelRatio = 设备像素的数量 / CSS 像素的数量</code>。这个比例也等价于 CSS 像素边长/设备像素边长。</p> <p>如 devicePixelRatio = 2，表示在相同长度的直线上，设备像素的数量是 CSS 像素数量的 2 倍，因此 CSS 像素的边长是设备像素的 2 倍。
比如retina屏，devicePixelRatio=2，这时候得设置viewport=&quot;initial-scale=0.5&quot;，才能保证在实际的开发中，和其他手机呈现的效果一样。</p> <h3 id="_1-2-viewport相关"><a href="#_1-2-viewport相关" class="header-anchor">#</a> 1.2 viewport相关</h3> <h4 id="_1-2-1-layout-viewport"><a href="#_1-2-1-layout-viewport" class="header-anchor">#</a> 1.2.1 layout viewport</h4> <p>layout viewport 为布局视口，即网页布局的区域，它是 html 元素的父容器，只要不在 css 中修改元素的宽度， 元素的宽度就会撑满 layout viewport 的宽度。
很多时候浏览器窗口没有办法显示出 layout viewport 的全貌，但是它确实是已经被加载出来了，这个时候滚动条就出现了，你需要通过滚动条来浏览 layout viewport 其他的部分。
layout viewport 用 css 像素来衡量尺寸，在缩放、调整浏览器窗口的时候不会改变。缩放、调整浏览器窗口改变的只是 visual viewport。
​
在桌面浏览器中，缩放100% 的时候，Layout Viewport 宽度等于内容窗口的宽度。（你几乎不会在电脑上见过横向滚动条，除非你调整缩放）
但是在移动端，缩放为 100% 的时候，Layout Viewport 不一定等于内容窗口的大小。当你用手机浏览浏览宽大的网页（这些网页没有采用响应式设计）的时候，你只能一次浏览网页的一个部分，然后通过手指滑动浏览其他部分。这就说明整个网页（Layout Viewport）已经加载出来了，只不过你要一部分一部分地看。</p> <h4 id="_1-2-2-visual-viewport"><a href="#_1-2-2-visual-viewport" class="header-anchor">#</a> 1.2.2 visual viewport</h4> <p>visual viewport 为视觉视口，就是显示在屏幕上的网页区域，它往往只显示 layout viewport 的一部分。
visual viewport 就像一台摄像机，layout viewport 就像一张纸，摄像机对准纸的哪个部分，你就能看见哪个部分。你可以改变摄像机的拍摄区域大小（调整浏览器窗口大小），也可以调整摄像机的距离（调整缩放比例），这些方法都可以改变 visual viewport，但是 layout viewport 始终不变。</p> <h4 id="_1-2-3-idel-viewport"><a href="#_1-2-3-idel-viewport" class="header-anchor">#</a> 1.2.3 idel viewport</h4> <p>ideal viewport 为理想视口，不同的设备有自己不同的 ideal viewport，ideal viewport 的宽度等于移动设备的屏幕宽度，所以其是最适合移动设备的 viewport。只要在 css 中把某一元素的宽度设为 ideal viewport 的宽度(单位用 px )，那么这个元素的宽度就是设备屏幕的宽度了，也就是宽度为100% 的效果。<br>
ideal viewport 的意义在于，无论在何种分辨率的屏幕下，那些针对ideal viewport 而设计的网站，不需要用户手动缩放，也不需要出现横向滚动条，都可以完美的呈现给用户。</p> <h4 id="_1-2-4-利用-meta-标签对-viewport-进行控制"><a href="#_1-2-4-利用-meta-标签对-viewport-进行控制" class="header-anchor">#</a> 1.2.4 利用 meta 标签对 viewport 进行控制</h4> <p>移动设备默认的 viewport 是 layout viewport，也就是那个比屏幕要宽的 viewport，但在进行移动设备网站的开发时，我们需要的是 ideal viewport。那么怎么才能得到 ideal viewport 呢？
我们在开发 h5 页面时，最经常见的标签如下所示</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><table><thead><tr><th style="text-align:center;">内容</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">width</td> <td style="text-align:center;">设置layout viewport 的宽度，为一个正整数，或字符串&quot;device-width&quot;</td></tr> <tr><td style="text-align:center;">initial-scale</td> <td style="text-align:center;">设置页面的初始缩放值，为一个数字，可以带小数</td></tr> <tr><td style="text-align:center;">maximum-scale</td> <td style="text-align:center;">允许用户的最大缩放值，为一个数字，可以带小数</td></tr> <tr><td style="text-align:center;">minimum-scale</td> <td style="text-align:center;">允许用户的最小缩放值，为一个数字，可以带小数</td></tr> <tr><td style="text-align:center;">height</td> <td style="text-align:center;">设置layout viewport 的高度，这个属性对我们并不重要，很少使用</td></tr> <tr><td style="text-align:center;">user-scalable</td> <td style="text-align:center;">是否允许用户进行缩放，值为&quot;no&quot;或&quot;yes&quot;, no 代表不允许，yes代表允许</td></tr></tbody></table> <h2 id="_2-方案选择"><a href="#_2-方案选择" class="header-anchor">#</a> 2 方案选择</h2> <h3 id="_2-1-media方案"><a href="#_2-1-media方案" class="header-anchor">#</a> 2.1 @media方案</h3> <p>基于 css 的媒体查询属性 @media  分别为不同屏幕尺寸的移动设备编写不同尺寸的 css 属性，示例如下所示。虽然此方法能在一定程度上解决移动设备适配的问题，但存在以下问题，所以这种方案几乎被淘汰。
页面上所有的元素都得在不同的 @media 中定义一遍不同的尺寸，这个代价有点高；
如果再多一种屏幕尺寸，就得多写一个 @media 查询块；</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 375px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.logo</span> <span class="token punctuation">{</span>
    <span class="token property">width</span> <span class="token punctuation">:</span> 62.5px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 360px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.logo</span> <span class="token punctuation">{</span>
    <span class="token property">width</span> <span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 320px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.logo</span> <span class="token punctuation">{</span>
    <span class="token property">width</span> <span class="token punctuation">:</span> 53.3333px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-rem适配方案"><a href="#_2-2-rem适配方案" class="header-anchor">#</a> 2.2 rem适配方案</h3> <p>举个🌰，假设现在图上有个宽度100px的按钮，UI图是750px的图。为了不同大小的屏幕适配，按钮我们应该写多少rem呢？
rem就是根元素的字体大小！根元素就是<code>&lt;html&gt;</code>标签。网页<code>&lt;html&gt;</code>的默认字体大小是 16px。也就是浏览器默认的字号16px。
则如果需要设置元素字体大小为 16px，则写为 1rem。</p> <h4 id="_2-2-1-使用-js-动态来设置根字体-典型代表就是-flexible-适配方案"><a href="#_2-2-1-使用-js-动态来设置根字体-典型代表就是-flexible-适配方案" class="header-anchor">#</a> 2.2.1 使用 js 动态来设置根字体（典型代表就是 <a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">flexible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 适配方案）</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> doc <span class="token operator">=</span> window<span class="token punctuation">.</span>document<span class="token punctuation">;</span>
<span class="token keyword">var</span> docEl <span class="token operator">=</span> window<span class="token punctuation">.</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">autoRootFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 移动端通常是除以32，为了让字更大一点，清晰一些。</span>
    <span class="token comment">/* 设计稿是750，采用1：100的比例，用1rem表示100px，为了计算更方便 */</span>
    docEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>screen<span class="token punctuation">.</span>width<span class="token punctuation">,</span> docEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">750</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> resizeEvt <span class="token operator">=</span> <span class="token string">'orientationchange'</span> <span class="token keyword">in</span> window <span class="token operator">?</span> <span class="token string">'orientationchange'</span> <span class="token operator">:</span> <span class="token string">'resize'</span><span class="token punctuation">,</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>resizeEvt<span class="token punctuation">,</span> autoRootFontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">autoRootFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-2-根据dpr设置viewport窗口适配retina高倍屏"><a href="#_2-2-2-根据dpr设置viewport窗口适配retina高倍屏" class="header-anchor">#</a> 2.2.2 根据dpr设置viewport窗口适配Retina高倍屏</h4> <p>设置 viewport 的 width 为 device-width，改变浏览器 viewport（布局视口和视觉视口）的默认宽度为理想视口宽度，从而使得用户可以在理想视口内看到完整的布局视口的内容。
等比设置 viewport 的 initial-scale、maximum-scale、minimum-scale 的值，从而实现 1 物理像素=1 css像素，以适配高倍屏的显示效果（就是在这个地方规避了大家熟知的“1px 问题”）</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">const</span> metaEl <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'meta[name=&quot;viewport&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dpr <span class="token operator">=</span> window<span class="token punctuation">.</span>devicePixelRatio <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token operator">?</span> <span class="token number">3</span><span class="token operator">:</span> window<span class="token punctuation">.</span>devicePixelRatio <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token operator">?</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token keyword">const</span> scale <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    docEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'data-dpr'</span><span class="token punctuation">,</span> dpr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>metaEl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        metaEl <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        metaEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'viewport'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        metaEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">width=device-width,initial-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,maximum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, minimum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, user-scalable=no</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        docEl<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>metaEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-2-3-根据postcss预处理器解决rem换算问题"><a href="#_2-2-3-根据postcss预处理器解决rem换算问题" class="header-anchor">#</a> 2.2.3 根据postcss预处理器解决rem换算问题</h4> <p>根字体随着屏幕大小而变化啦，那么不可能每次写css还要去换算应该写多少rem吧，那么多css，要写哭，所以建议用css预处理器PostCSS。
这里用到的两个插件autoprefixer、postcss-pxtorem：
autoprefixer就是给css前面加上合适的前缀，这点少写了很多行代码是不是。
postcss-pxtorem就是把px转换成rem，这也就是我们上面根字体改变了，px也可以换算成rem，但是这个插件就可以根据你的根字体，自动换算rem，是不是很方便。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// postcss.config.js文件</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">autoprefixer</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">'postcss-pxtorem'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">rootValue</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
      <span class="token literal-property property">propList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">minPixelValue</span><span class="token operator">:</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-4-缺陷"><a href="#_2-2-4-缺陷" class="header-anchor">#</a> 2.2.4 缺陷</h4> <p>（1）由于其缩放的缘故，video 标签的视频频播放器的样式在不同 dpr 的设备上展示差异很大；
（2）不再兼容 @media 的响应式布局，因为 @media 语法中涉及到的尺寸查询语句，查询的尺寸依据是当前设备的物理像素，和 rem方案（即针对不同 dpr 设备等比缩放视口的 scale 值，从而同时改变布局视口和视觉视口大小）相悖，因此响应式布局在“等比缩放视口大小”的情境下是无法正常工作的；
其实 flexible 方案是在 模拟 viewport 功能，只是随着浏览器的发展及兼容性增强，viewport 已经能兼容绝大部分主流浏览器，并且 flexible 方案自身存在的问题，所有其也已几乎退出历史潮流。</p> <h3 id="_2-3-viewport-适配方案"><a href="#_2-3-viewport-适配方案" class="header-anchor">#</a> 2.3 viewport 适配方案</h3> <p>由于 viewport 单位得到众多浏览器的兼容，所以目前基于 viewport 的移动端适配方案被各大厂团队所采用。
vw 作为布局单位，从底层根本上解决了不同尺寸屏幕的适配问题，因为每个屏幕的百分比是固定的、可预测、可控制的。 viewport 相关概念如下：</p> <table><thead><tr><th style="text-align:center;">内容</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">vw</td> <td style="text-align:center;">viewport's width 的简写，1vw 等于 window.innerWidth 的 1%</td></tr> <tr><td style="text-align:center;">vh</td> <td style="text-align:center;">viewport's height 的简写，1vh 等于 window.innerHeihgt 的 1%</td></tr> <tr><td style="text-align:center;">vmin</td> <td style="text-align:center;">vmin 的值是当前 vw 和 vh 中较小的值</td></tr> <tr><td style="text-align:center;">vmax</td> <td style="text-align:center;">vmax 的值是当前 vw 和 vh 中较大的值</td></tr></tbody></table> <p>假设我们拿到的视觉稿宽度为 750px，视觉稿中某个字体大小为 75px，则我们的 css 属性只要如下这么写，不需要额外的去用 js 进行设置，也不需要去缩放屏幕等；</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.logo</span> <span class="token punctuation">{</span>
  // 1vw = 750px / 100 = 7.5px
  <span class="token property">font-size</span><span class="token punctuation">:</span> 10vw<span class="token punctuation">;</span>1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size1vw750px1007.5pxfont-size
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-3-1-设置meta标签"><a href="#_2-3-1-设置meta标签" class="header-anchor">#</a> 2.3.1 设置meta标签</h4> <p>在 html 头部设置 mata 标签如下所示，让当前 viewport 的宽度等于设备的宽度，同时不允许用户手动缩放。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><h4 id="_2-3-2-px自动转换为vw"><a href="#_2-3-2-px自动转换为vw" class="header-anchor">#</a> 2.3.2 px自动转换为vw</h4> <p>设计师一般给宽度大小为 375px 或 750px 的视觉稿，我们采用 vw 方案的话，需要将对应的元素大小单位 px 转换为 vw 单位，这是一项影响开发效率（需要手动计算将 px 转换为 vw）且不利于后续代码维护（css 代码中一堆 vw 单位，不如 px 看的直观）的事情；好在社区提供了 <a href="https://github.com/evrone/postcss-px-to-viewport" target="_blank" rel="noopener noreferrer">postcss-px-to-viewport<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 插件，来将 px 自动转换为 vw，相关配置步骤如下：
（1） 安装插件</p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add postcss<span class="token operator">-</span>px<span class="token operator">-</span>to<span class="token operator">-</span>viewport <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>（2）webpack 配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token string-property property">'postcss-px-to-viewport'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// options</span>
      <span class="token literal-property property">unitToConvert</span><span class="token operator">:</span> <span class="token string">'px'</span><span class="token punctuation">,</span>    <span class="token comment">// 需要转换的单位，默认为&quot;px&quot;</span>
      <span class="token literal-property property">viewportWidth</span><span class="token operator">:</span> <span class="token number">750</span><span class="token punctuation">,</span>     <span class="token comment">// 设计稿的视窗宽度</span>
      <span class="token literal-property property">unitPrecision</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>       <span class="token comment">// 单位转换后保留的精度</span>
      <span class="token literal-property property">propList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'!font-size'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// 能转化为 vw 的属性列表</span>
      <span class="token literal-property property">viewportUnit</span><span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span>     <span class="token comment">// 希望使用的视窗单位</span>
      <span class="token literal-property property">fontViewportUnit</span><span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span> <span class="token comment">// 字体使用的视窗单位</span>
      <span class="token literal-property property">selectorBlackList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 需要忽略的 CSS 选择器，不会转为视窗单位，使用原有的 px 等单位</span>
      <span class="token literal-property property">minPixelValue</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>       <span class="token comment">// 设置最小的转换数值，如果为 1 的话，只有大于 1 的值会被转换</span>
      <span class="token literal-property property">mediaQuery</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token comment">// 媒体查询里的单位是否需要转换单位</span>
      <span class="token literal-property property">replace</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>          <span class="token comment">// 是否直接更换属性值，而不添加备用属性</span>
      <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>     <span class="token comment">// 忽略某些文件夹下的文件或特定文件，例如 'node_modules' 下的文件</span>
      <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/src\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>     <span class="token comment">// 如果设置了include，那将只有匹配到的文件才会被转换</span>
      <span class="token literal-property property">landscape</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>       <span class="token comment">// 是否添加根据 landscapeWidth 生成的媒体查询条件</span>
      <span class="token literal-property property">landscapeUnit</span><span class="token operator">:</span> <span class="token string">'vw'</span><span class="token punctuation">,</span>    <span class="token comment">// 横屏时使用的单位</span>
      <span class="token literal-property property">landscapeWidth</span><span class="token operator">:</span> <span class="token number">1125</span><span class="token punctuation">,</span>   <span class="token comment">// 横屏时使用的视窗宽度</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>propList 属性，我们配置了 font-size 不进行转换 vw，也就是说在不同手机屏幕尺寸下的字体大小是一样的。
其中 font-size 是否需要根据屏幕大小做适配，或者怎么做，一直是个争论不休的话题；考虑到我们移动端没有平板的需求，且咨询过团队业务设计师的意见，所以对模版进行以上默认配置；当然如果你的视觉要求你的项目要做字体大小适配，修改 propList 属性的配置即可。</p> <h4 id="_2-3-3-retina高清屏问题解决"><a href="#_2-3-3-retina高清屏问题解决" class="header-anchor">#</a> 2.3.3 Retina高清屏问题解决</h4> <p>考虑 Retina 屏场景，可能对图片的高清程度、1px 等场景有需求，所以我们预留判断 Retina 屏坑位。
相关方案如下：在入口的 html 页面进行 dpr 判断，以及 data-dpr 的设置；然后在项目的 css 文件中就可以根据 data-dpr 的值根据不同的 dpr 写不同的样式类；
（1）index.html 文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> dpr <span class="token operator">=</span> devicePixelRatio <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token operator">?</span> <span class="token number">3</span><span class="token operator">:</span> devicePixelRatio <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token operator">?</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'data-dpr'</span><span class="token punctuation">,</span> dpr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-viewport适配方案特定场景问题"><a href="#_3-viewport适配方案特定场景问题" class="header-anchor">#</a> 3 viewport适配方案特定场景问题</h2> <h3 id="_3-1-行内样式的场景"><a href="#_3-1-行内样式的场景" class="header-anchor">#</a> 3.1 行内样式的场景</h3> <p>当你需要写行内样式的代码（style）时，[postcss-px-to-viewport] 插件 无法进行 px 单位无法转换，需要自己手动计算好 vw；
解决方案：通过添加、修改、删除 className 的方式进行处理此类场景，不直接操作行内样式，这更符合将 js 和 css 隔离开的更佳实践。
​</p> <h3 id="_3-2-1px-的问题"><a href="#_3-2-1px-的问题" class="header-anchor">#</a> 3.2 1px 的问题</h3> <p>retina 屏下 1px 问题是个常谈的问题，相比较普通屏，retina 屏的 1px 线会显得比较粗，设计美感欠缺；在视觉设计师眼里的 1px 是指设备像素 1px（设计师眼中的1px如下图），而如果我们直接写 css 的大小 1px，那在 dpr = 2 时，则等于 2px 设备像素，dpr = 3 时，等于 3px 设备像素。所以对于要求处理 1px 的场景，我们要进行特殊处理。
<img src="/assets/img/1-px.2160fe13.jpeg" alt="设计师眼中的1px"> 
以下介绍常用的几种方法</p> <h4 id="_3-2-1-transform-scale-0-5"><a href="#_3-2-1-transform-scale-0-5" class="header-anchor">#</a> 3.2.1 transform: scale(0.5)</h4> <p>可以使用 transform: scale(0.5) 进行 X、Y 轴的缩放，如下示例所示</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.class1</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span> 
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优点是编写简单，但是如果实现上下左右四条边框会比较难搞，并且如果有嵌套存在的话，会对包含的元素产生影响，所以结合 :before 和 :after 来使用。
​</p> <h4 id="_3-2-2-transform-scale-0-5-before-after-推荐"><a href="#_3-2-2-transform-scale-0-5-before-after-推荐" class="header-anchor">#</a> 3.2.2 transform: scale(0.5) + :before / :after （推荐）</h4> <p>此种方式能解决例如 标签上下左右边框 1px 的场景，以及有嵌套元素存在的场景，比较通用，示例如下所示</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.calss1</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token selector">&amp;::before</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span>
    <span class="token property">border-top</span><span class="token punctuation">:</span>1px solid #666<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
      <span class="token selector">&amp;:before</span> <span class="token punctuation">{</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
          <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> 2.5<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
      <span class="token selector">&amp;:before</span> <span class="token punctuation">{</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 250%<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> 250%<span class="token punctuation">;</span>
          <span class="token property">-webkit-transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>.4<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-3、box-shadow"><a href="#_3-2-3、box-shadow" class="header-anchor">#</a> 3.2.3、box-shadow</h4> <p>利用 css 对阴影处理来模拟边框，示例如下所示，底部一条线，缺点是存在阴影不好看。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">[data-dpr='2'] .class1</span> <span class="token punctuation">{</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 1px 1px -1px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-4-其它"><a href="#_3-2-4-其它" class="header-anchor">#</a> 3.2.4 其它</h4> <p>还有如下等方式处理 1px 问题，但不推荐，了解即可</p> <p>viewport: 将页面进行缩小处理；
border-image：切个 1px 图片来模拟；
background-image：切个 1px 图片来模拟；
linear-gradient：通过线性渐变，来实现移动端 1px 的线；
svg：基于矢量图形(svg) 在不同设备屏幕特性下具有伸缩性。</p> <h3 id="_3-3-图片高清还原的问题"><a href="#_3-3-图片高清还原的问题" class="header-anchor">#</a> 3.3 图片高清还原的问题</h3> <p>一个位图像素是栅格图像(如：png, jpg, gif等)最小的数据单元。每一个位图像素都包含着一些自身的显示信息(如：显示位置，颜色值，透明度等)。理论上，1个位图像素对应于1个物理像素，图片才能得到完美清晰的展示。</p> <h4 id="_3-3-1-适用普通屏的图片在-retina-屏中-图片展示就会显得模糊"><a href="#_3-3-1-适用普通屏的图片在-retina-屏中-图片展示就会显得模糊" class="header-anchor">#</a> 3.3.1 适用普通屏的图片在 retina 屏中，图片展示就会显得模糊</h4> <p>对于dpr=2的Retina屏幕而言，1个位图像素对应于4个物理像素，由于单个位图像素不可以再进一步分割，所以只能就近取色，导致图片看起来比较模糊，如下图。
<img src="/assets/img/screen-original.a0795898.png" alt="普通图片"></p> <p>对于图片模糊问题，比较好的方案就是用多倍图片(@2x)。如：一个200×300(CSS pixel)的img标签，对于dpr=2的屏幕，用400×600的图片，如此一来，位图像素点个数就是原来的4倍，在Retina屏幕下，位图像素点个数就可以跟物理像素点个数形成 1 : 1的比例，图片自然就清晰了。</p> <h4 id="_3-3-2-适用-retina-屏的图片在普通屏中-图片展示就会缺少色差、没有锐利度-并且浪费带宽"><a href="#_3-3-2-适用-retina-屏的图片在普通屏中-图片展示就会缺少色差、没有锐利度-并且浪费带宽" class="header-anchor">#</a> 3.3.2 适用 retina 屏的图片在普通屏中，图片展示就会缺少色差、没有锐利度，并且浪费带宽</h4> <p>在普通屏幕下，200×300(CSS pixel)img标签，所对应的物理像素个数就是200×300个，而两倍图片的位图像素个数是200×300×4个，所以就<code>出现一个物理像素点对应4个位图像素点，但它的取色也只能通过一定的算法取某一个位图像素点上的色值，这个过程叫做(downsampling)</code>，肉眼看上去虽然图片不会模糊，但是会觉得图片缺少一些锐利度，或者是有点色差，如下图。
<img src="/assets/img/screen-high.a05efe2d.png" alt="高清图片"></p> <p>所以如果对性能、美观要求很高的场景，需要根据 dpr 区分使用对应的图片，相关 css 写法如下：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">[data-dpr='1'] .logo</span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>image@1x.jpg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">[data-dpr='2'] .logo</span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>image@2x.jpg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">[data-dpr='3'] .logo</span> <span class="token punctuation">{</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>image@3x.jpg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参考文档"><a href="#参考文档" class="header-anchor">#</a> 参考文档</h2> <p><a href="https://zhuanlan.zhihu.com/p/425121653" target="_blank" rel="noopener noreferrer">超全面H5页面适配之「viewport」<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/broswer/pageshow-visibilitychange.html" class="prev">
        pageshow、pagehide、visibilitychange对比
      </a></span> <span class="next"><a href="/blog/engineer/cli.html">
        从 0 打造属于自己的脚手架
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.92dc81f6.js" defer></script><script src="/assets/js/2.2d54ebdc.js" defer></script><script src="/assets/js/10.01084cac.js" defer></script>
  </body>
</html>
